---
title: "Confidence Intervals Using R"
author: Orville D. Hombrebueno
output: slidy_presentation
---
```{r include=FALSE}
knitr::opts_chunk$set(comment = '')
knitr::opts_chunk$set(prompt = T)
```
**Outline**

- Introduction to **R**
    a. The **R** Environment
    b. RStudio
    c. Data Type and Objects
    d. Basic Commands
    e. Creating Functions in R
- Confidence Intervals for the Mean (Large Samples)
    a. Finding a Confidence Interval for a Population Mean
- Confidence Intervals for the Mean (Small Samples)
    a. Constructing a Confidence Interval for the Mean: $t$-Distribution
- Confidence Intervals for Population Proportions
    a. Constructing a Confidence Interval for a Population Proportion
    b. Finding a Minimum Sample Size to Estimate $p$
- Confidence Intervals for Variance and Standard Deviation
    a. Constructing a Confidence Interval for a Variance and Standard Deviation

# Introduction to **R**

## The **R** Environment  
- **R** is an integrated suite of software facilities for data manipulation, calculation and graphical display.
- It is an open-source software environment for statistical computing and graphics.
- It is an environment within which many classical and modern statistical techniques have been implemented.
- A few of these techniques are built into the base **R** environment, but many are supplied as packages.
- **R** is an *expression language* with a very simple syntax. It is *case sensitive*.
- The entities that **R** creates and manipulates are known as *objects*. These may be variables, arrays of numbers, character strings, functions, or more general structures built from such components.

## RStudio
- R Studio provides a graphical interface for **R**. The components of the environment are all nicely integrated into a four-panel layout.  
![](RStudio_interface.png)
- The RStudio provides most of the desired features of **R** in an Integrated Development Environment (IDE).
- The **console** provides the command-line interface for interactive use of **R**. This is where users issue commands for **R** to evaluate.
- The **source** tab is a built-in text editor.
- The **Environment** tab is an interactive list of **R** objects.
- The **Files** tab displays the files and sub directories of a given directory.
- Display of graphics is rendered in the **Plots** tab.
- RStudio keeps a stack of past commands and allows one to scroll through them easily. This can be done using the up or down keys. In addition, the **History** tab allows one to scroll through past commands.
- The **Packages** tab allows users to effortlessly load, install, update, and/or delete packages in the library of packages.
- The **Help** tab is an output location for help commands and help search window.
- The **Viewer** tab is an advanced tab for local web content.

## Data Type and Objects
- Scalars -- atomic quantity and can hold only one value at a time.  
Examples: number, logical value, character(string)
- Vector -- a sequence of data elements of the same basic type.
- Matrix -- a collection of data elements in a rectangular layout.
- Data Frame -- more general than a matrix, in that different columns can have different basic types.
- List -- a generic vector containing other objects.

## Basic Commands
- Before everything else, set your working directory. Setting the working directory is choosing a folder to save your work. You can set the working directory using the File tab or the function `setwd()`.
- Typing `?funcname` will cause **R** to open a new help file window with additional information about the function `funcname`.
- We can assign values in **R** using the "`<-`" operator.  
*Example*
```{r}
x <- 143
x
```
```{r}
y <- 198
y
```
```{r}
x + y
```
```{r}
z <- x + y
z
```
- **R** uses *functions* to perform operations. To run a function called `funcname`, we type  
`funcname(input1, input2)`  
*Example*  
We use the function `c()` to create a vector of numbers.
```{r}
x <- c(1, 4, 3, 4, 4)
x
```
- Note that the prompt, `>`, is not part of the command; rather, it is printed by **R** to indicate that it is ready for another command to be entered.
- Hitting the *up arrow key* multiple times will display the previous commands, which can then be edited.
- a plus sign, `+`, replacing `>` indicates that your code is not complete and that **R** is asking you to complete your code.
- The `ls()` function allows us to look at a list of all of the objects, such as data and functions, that we have in the environment. The `rm()` function can be used to delete any that we donâ€™t want.

## Creating Functions in R
- We can write functions in R!  
*Example*  
Suppose we want to write a function for average. The formula for average is  
$$average=\frac{\sum{x}}{n}$$  
where $x$ is a vector and $n$ is a scalar containing the number of elements in $x$.  
```{r}
average <- function(x){
  sum(x)/length(x)
}
```
```{r}
y <- c(4, 3, 5, 1, 7)
```
```{r}
average(y)
```  
or  
```{r}
average <- function(x){
  a <- sum(x)
  b <- length(x)
  c <- a/b
  return(c)
}
```
```{r}
average(y)
```  
or  
```{r}
mean(y)
```

# Confidence Intervals for the Mean (Large Samples)

## Finding a Confidence Interval for a Population Mean

1. Find the sample statistics $n$ and $\bar{x}$.  
$$\bar{x}=\frac{\sum{x}}{n}$$  
In **R** we have the function `mean()`.
2. Specify $\sigma$, if known. Otherwise, if $n\ge 30$, find the sample standard deviation $s$ and use it as an estimate for $\sigma$.  
$$s=\sqrt{\frac{\sum{(x-\bar{x})^2}}{n-1}}$$  
In **R** we have the function `sd()`.
3. Find the critical value $z_{c}$ that corresponds to the given level of confidence.  
*Example*  
For $c=95\%\;\text{ or }\; 0.95$
```{r}
qnorm((1+0.95)/2)
```
4. Find the margin of error $E$.  
$$E=z_{c}\frac{\sigma}{\sqrt{n}}$$
5. Find the left and right endpoints and form the confidence interval.  
LEP  
$$\bar{x}-E$$  
REP  
$$\bar{x}+E$$  
Interval  
$$\bar{x}-E<\mu<\bar{x}+E$$
or  
$$(\bar{x}-E,\;\bar{x}+E)$$  

*Example*  

Construct a 95% confidence interval for the population mean. Interpret your answer.

1. The stem-and-leaf plot shows the result of a random sample of airfare prices (in dollars) for a one-way ticket from Boston, MA to Chicago, IL.
```{r include=FALSE}
x<-c(183,183,197,209,209,212,212,212,213,213,213,213,213,213,213,216,216,222,222,222,222,223,226,226,228,228,228,228,228,229,238,238)
```
```{r echo=FALSE}
stem(x)
```

*Exercise*

2. A random sample of the closing stock prices for the Oracle Corporation for a recent year.
```{r include=FALSE}
x<-c(18.41,18.32,22.86,14.47,16.91,18.65,20.86,19.06,16.83,20.71,20.74,18.42,17.72,20.66,22.05,20.85,15.54,21.04,21.42,21.43,15.56,21.74,22.34,21.97,18.01,22.13,22.83,21.81,19.11,21.96,24.34,19.79,22.16,17.97)
```
```{r echo=FALSE}
x
```

# Confidence Intervals for the Mean (Small Samples) 

## Constructing a Confidence Interval for the Mean: $t$-Distribution

1. Find the sample statistics $n$, $\bar{x}$, and $s$.  
$$\bar{x}=\frac{\sum{x}}{n},\;\;s=\sqrt{\frac{\sum{(\bar{x}-x)^2}}{n-1}}$$
2. Identify the degrees of freedom, the level of confidence $c$, and the $t_{c}$.
$$\text{d.f.}=n-1$$
*Example*  
For $c=95\%\;\text{ or }\; 0.95$ and $\text{d.f.}=16$
```{r}
qt((1+0.95)/2, df = 16)
```
3. Find the margin of error $E$.
$$E=t_{c}\frac{s}{\sqrt{n}}$$
4. Find the left and right endpoints and form the confidence interval.  
LEP  
$$\bar{x}-E$$  
REP  
$$\bar{x}+E$$  
Interval  
$$\bar{x}-E<\mu<\bar{x}+E$$
or  
$$(\bar{x}-E,\;\bar{x}+E)$$

*Exercise*  

Construct a 90% confidence interval for the population mean. Assume the population of each data set is normally distributed. Interpret your answer.

1. The annual earnings (in pesos) of 14 randomly selected engineers.
```{r include=FALSE}
x <- c(63118, 65740, 72899, 68500, 66726, 65554, 69247,
       64963, 68627, 70448, 71842, 66873, 74103, 71138)
```
```{r echo=FALSE}
x
```

